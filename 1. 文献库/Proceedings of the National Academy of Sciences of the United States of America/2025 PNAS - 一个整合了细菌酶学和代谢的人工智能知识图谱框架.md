
**2025 PNAS | 一个整合了细菌酶学和代谢的人工智能知识图谱框架**

![...](..\Proceedings%20of%20the%20National%20Academy%20of%20Sciences%20of%20the%20United%20States%20of%20America\images\2025%20PNAS%20-%20一个整合了细菌酶学和代谢的人工智能知识图谱框架.001.png)

**一：基本信息**

**文章题目**：An integrated AI knowledge graph framework of bacterial enzymology and metabolism

**文章 DOI 号**：10.1073/pnas.2425048122

**期刊名称**：Proceedings of the National Academy of Sciences of the United States of America (PNAS)

**通讯作者**：Nathan A. Magarvey

**通讯作者工作单位**：麦克马斯特大学 (McMaster University)

**二：核心速览**

**研究背景**

本研究旨在解决后基因组时代细菌代谢研究的核心瓶颈：随着基因组测序数据的爆炸式增长，现有的生物信息学工具在处理和解析海量数据方面面临着可扩展性差、计算成本高、不同工具间互操作性有限等挑战。传统的工具（如基于隐马尔可夫模型 pHMM 的方法）在识别新颖酶和比较大规模代谢通路上能力有限。因此，亟需开发一种全新的、高效、可扩展且整合的计算框架，以系统性地从基因组数据中挖掘和理解细菌复杂的代谢潜力，包括初级代谢 (Primary Metabolism, PM) 和次级代谢 (Specialized Metabolism, SM)。

**前期研究**

在本文发表前，该领域的研究现状主要依赖以下技术：

1. **基于 pHMM 的注释**：使用如 PFAM 数据库的 pHMMs 来识别蛋白质保守基序和预测功能。antiSMASH 和 PRISM 等主流的生物合成基因簇 (BGC) 挖掘工具严重依赖这些 pHMM 库。
2. **序列比对工具**：如 BLAST 和 DIAMOND，通过序列相似性进行功能注释，但在处理远源同源蛋白时效果不佳。
3. **BGC 比较工具**：如 BiG-SCAPE 和 BiG-SLICE，通过比较 BGC 内的保守结构域来进行家族分类，但计算量随数据量二次方增长，难以处理百万级别的 BGC 数据集。
4. **早期的机器学习模型**：如 DeepEC 等，已开始尝试使用深度学习进行酶功能分类，但通常只专注于单一任务（如 EC 号码预测），且泛化能力和覆盖度有限。

**本文突破点**

![...](..\Proceedings%20of%20the%20National%20Academy%20of%20Sciences%20of%20the%20United%20States%20of%20America\images\2025%20PNAS%20-%20一个整合了细菌酶学和代谢的人工智能知识图谱框架.002.png)

1. **提出了一个统一的 AI 框架 (IBIS)**：开发了一个名为“**整合生物合成推断套件**” (Integrated Biosynthetic Inference Suite, IBIS) 的综合平台，首次将多种先进的 AI 模型（Transformer, Graphormer）应用于细菌代谢的全流程分析，涵盖了从单个酶、结构域到完整代谢通路（PM 和 SM）的注释、分类和比较。
2. **引入“嵌入” (Embedding) 概念**：核心创新在于使用 Transformer 模型将蛋白质序列和整个 BGC 转化为低维、信息密集的数值向量（即“嵌入”）。这种表示方式使得功能相似的生物实体在数学空间中彼此靠近，从而可以用高效的向量运算替代耗时的序列比对，极大地提升了分析的速度和可扩展性。
3. **构建了整合的知识图谱 (Knowledge Graph)**：将所有 AI 模型的预测结果与物种分类、生态位（如宿主、环境来源）等元数据整合到一个庞大的知识图谱中，实现了跨领域数据的关联分析和智能化的科学假说生成。
4. **实现了卓越的性能和可扩展性**：在准确性、覆盖度和速度上全面超越了现有主流工具。例如，在 BGC 化学型预测上优于 antiSMASH，在 BGC 比较的化学意义上远胜于 BiG-SLICE，并在不到一小时内完成了近 200 万个 BGC 的比较。
5. **完成了关键预测的实验验证**：通过湿实验验证了 IBIS 的预测能力，成功从目标菌株中分离并鉴定出预测的化合物及其新颖衍生物，有力地证明了该计算框架的实际应用价值。

**研究难点**

1. **构建高质量、多任务的 AI 模型**：设计并训练能够同时处理多种不同生物学任务（如 EC 号码分类、生物合成结构域识别、底物特异性预测等）的 Transformer 模型，需要复杂的模型架构和精巧的多任务训练策略。
2. **生成具有生物化学意义的嵌入**：最大的挑战是确保 AI 模型产生的数值向量（嵌入）能够真实反映生物化学功能。例如，为了让 BGC 的嵌入能够代表其产物的化学结构，作者采用了“对比学习” (contrastive learning) 策略，利用化合物的化学相似性（Tanimoto 系数）来指导模型的训练，这是一个非常精妙的设计。
3. **大规模异构数据的整合与处理**：整合来自 KEGG, MIBiG, UniProt, BacDive 等多个公共数据库的、格式各异的海量数据，并将其结构化以便用于模型训练和知识图谱构建，是一项巨大的数据工程挑战。

**三：研究方法**

- **Transformer 模型**：利用其强大的上下文信息提取能力（自注意力机制），构建了 IBIS-Enzyme 和 IBIS-Domain 模型。这些模型将蛋白质或结构域的氨基酸序列作为输入，输出一个能代表其功能的数值向量（嵌入）。
- **Graphormer 模型**：这是一种为图结构数据优化的 Transformer。作者用它构建了 IBIS-SM 和 IBIS-BGC 模型。IBIS-SM 将基因组的一个区域视为一个“图”（节点是基因，边是基因间的距离），用于识别 BGC。IBIS-BGC 则将一个完整的 BGC（包含其所有基因、结构域和化学类型信息）整体编码为一个图，并生成一个代表该 BGC 的最终嵌入。
- **近似最近邻 (ANN) 分类**：利用 IBIS-Enzyme 生成的蛋白质嵌入，通过在向量数据库 (Qdrant) 中进行超快速的 ANN 搜索，来查找功能最相似的已知蛋白，从而完成对未知蛋白的功能注释。这比传统的 BLAST 比对快几个数量级。
- **知识图谱 (Knowledge Graph)**：使用图数据库 (Neo4j) 技术，将所有实体（如细菌、基因、BGC、代谢通路）作为节点，将它们之间的关系（如“编码”、“属于”、“分离自”）作为边，构建一个庞大的、可查询的生物信息网络。
- **湿实验验证 (Wet-Lab Validation)**：通过菌株培养、代谢物提取、高分辨率质谱 (HR-MS) 分析和核磁共振 (NMR) 结构解析等经典的天然产物化学手段，对 IBIS 预测的 BGC-化合物关联性进行实验验证。

**四：实验设计及结果分析**

**研究部分一：IBIS-Enzyme——构建高精度、高通量的酶功能注释引擎**

**实验目的与设计**

本部分旨在开发并验证一个基于 Transformer 的模型 (IBIS-Enzyme)，用于对细菌蛋白进行功能注释，目标是超越现有工具的准确性、覆盖度和速度。

设计思路是：

1. 在一个包含 EC 编码酶、次级代谢相关蛋白家族和非酶蛋白的庞大数据集上，对 IBIS-Enzyme 模型进行多任务训练。
2. 通过与多种现有工具（包括基于规则的 antiSMASH 和其他深度学习模型如 CLEAN, DeepEC）在标准测试集上进行性能比较（如 F1 分数、覆盖率）。
3. 评估其对训练集中未见过的“新”酶的泛化能力。
4. 测试其注释大规模蛋白质序列时的计算速度。

**实验结果与分析** 

IBIS-Enzyme 表现出卓越的性能。它不仅能进行高精度的 EC 号码预测，还能识别次级代谢中特有的、没有 EC 编号的蛋白家族，并能精确划分多模块巨酶（如 PKS/NRPS）中的功能结构域。

- **Figure 2A (示意图)**：展示了 IBIS-Enzyme 的核心思想：将蛋白质序列映射到“酶嵌入空间”，功能相似的蛋白在空间中聚集。

![...](..\Proceedings%20of%20the%20National%20Academy%20of%20Sciences%20of%20the%20United%20States%20of%20America\images\2025%20PNAS%20-%20一个整合了细菌酶学和代谢的人工智能知识图谱框架.003.png)

- **Figure 2B (UMAP 降维图)**：直观地展示了 IBIS-Enzyme 的学习效果。图中，来自训练集之外的、具有不同 EC 号码的酶，其嵌入向量在二维空间中形成了清晰的、按功能分类的簇。这证明了模型具有很强的泛化能力，可以识别新酶。
- **Figure 2C (覆盖率柱状图)**：比较了 IBIS-Enzyme 与传统工具 (antiSMASH, PRISM) 对不同化学类型 BGC 的基因注释覆盖率。结果显示，IBIS 的覆盖率显著更高（P-value < 1e-10），因为它能识别更多样化的酶，而不局限于预定义的 pHMM 库。

![...](..\Proceedings%20of%20the%20National%20Academy%20of%20Sciences%20of%20the%20United%20States%20of%20America\images\2025%20PNAS%20-%20一个整合了细菌酶学和代谢的人工智能知识图谱框架.004.png)

- **Figure 2D (性能表格)**：定量比较了 IBIS-Enzyme 与其他先进深度学习工具在 EC 号码预测任务上的 F1 分数。IBIS 在所有层级的 EC 预测上均达到或超过了最高水平（如 EC1-4 的 F1 分数分别为 0.98, 0.98, 0.97, 0.95）。此外，它还能准确预测 SM 蛋白家族和生物合成结构域，F1 分数分别达到 0.91 和 0.89，展现了其多功能性。
- **Figure 2E (速度曲线图)**：展示了 IBIS-Enzyme (ANN 模式) 在注释蛋白时惊人的速度优势。在处理 100,000 条序列时，其速度比 DIAMOND 快 5.7 倍，比基于 PFAM 的 hmmscan 快 19.9 倍。这证明了其在大规模基因组分析中的巨大潜力。

**研究部分二：IBIS-SM——不依赖 pHMM 的高精度 BGC 识别与分类**

**实验目的与设计**

本部分旨在开发一个基于 Graphormer 的模型 (IBIS-SM)，它能够直接从基因组序列的上下文信息中识别 BGC 并预测其产物的化学类型，从而摆脱对固定 pHMM 库的依赖。

设计思路是：

1. 将基因组片段表示为图结构，其中节点是 IBIS-Enzyme 生成的蛋白质嵌入，边代表基因间的距离。
2. 在大量已知 BGC 数据上训练 IBIS-SM 模型，使其学会识别 BGC 的典型基因组织模式。
3. 在 MIBiG（已知 BGC 数据库）测试集上，将其预测化学类型和边界的准确性与现有主流工具进行比较。

**实验结果与分析**

IBIS-SM 作为一个不依赖于预定义规则的机器学习模型，在 BGC 识别和分类任务上表现出色。它能够学习到比手动设计的规则更普适、更灵活的模式，因此在识别新颖或非典型的 BGC 方面具有优势。

- **Figure 3A (示意图)**：展示了 IBIS-SM 的工作流程。通过对基因组进行“滑动窗口”分析，将每个窗口转化为一个蛋白质图，然后由 Graphormer 模型判断其中的基因是否属于 BGC 并赋予其化学类型。

![...](..\Proceedings%20of%20the%20National%20Academy%20of%20Sciences%20of%20the%20United%20States%20of%20America\images\2025%20PNAS%20-%20一个整合了细菌酶学和代谢的人工智能知识图谱框架.005.png)

- **Figure 3B (AUC 热图)**：这是本部分的核心结果。该图比较了 IBIS-SM 与四种其他工具 (ClusterFinder, DeepBGC, PRISM, antiSMASH) 在 MIBiG 数据集上预测多种 BGC 化学类型的性能（以 AUC 值为指标）。结果清晰显示，IBIS 在几乎所有类别上都取得了最高的 AUC 值（如生物碱 0.95, 萜烯 0.95, RiPP 0.98），全面优于其他工具。在 BGC 边界预测上，其 AUC 值 (0.74) 也高于其他工具。

**研究部分三：IBIS-BGC——实现化学感知的大规模 BGC 比较**

**实验目的与设计**

本部分旨在开发一个终极模型 (IBIS-BGC)，能够将一个完整的 BGC 压缩成一个单一的、能够反映其最终产物化学结构的嵌入向量，从而实现前所未有的大规模、高通量 BGC 比较和家族聚类。

设计思路是：

1. 设计一个 Graphormer 模型，输入是一个 BGC 的完整信息图（包含所有基因嵌入、结构域嵌入和化学类型）。
2. 采用对比学习策略进行训练：利用已知 BGC 产物的化学相似度（Tanimoto 系数）作为监督信号，强制模型学习，使得产物相似的 BGCs 其嵌入向量在空间中也彼此靠近。
3. 通过计算 BGC 嵌入距离与产物化学相似度的相关性，来验证嵌入的化学意义，并与 BiG-SLICE 进行比较。
4. 将该模型应用于一个包含超过 12 万个基因组的庞大数据集，展示其聚类和可视化能力。

**实验结果与分析**

IBIS-BGC 成功地将复杂的遗传信息（BGC）与化学信息（分子结构）联系起来。其生成的嵌入向量不仅是一个数字串，更是 BGC 生物合成潜能的一种“化学指纹”。

![...](..\Proceedings%20of%20the%20National%20Academy%20of%20Sciences%20of%20the%20United%20States%20of%20America\images\2025%20PNAS%20-%20一个整合了细菌酶学和代谢的人工智能知识图谱框架.006.png)

- **Figure 4A (示意图)**：生动地展示了对比学习的训练过程。模型被训练来区分“正样本对”（产物相似的 BGCs）和“负样本对”（产物不相似的 BGCs），从而优化嵌入空间。
- **Figure 4B (相关性热图)**：这是证明 IBIS-BGC 成功的关键证据。图中显示，IBIS-BGC 嵌入距离与 Tanimoto 化学相似度的皮尔逊相关系数 (r) 达到了 0.480，而 BiG-SLICE 的相关系数仅为 0.153。这表明 IBIS 的嵌入与真实的化学结构相关性强得多，是真正“化学感知”的。
- **Figure 4C (BGC 全景 UMAP 图)**：这张图展示了该技术的宏大应用场景。作者将来自 121,056 个基因组的近 200 万个 BGCs 嵌入并进行降维可视化，形成了细菌生物合成潜力的“星图”。图中，具有相似化学类型的 BGCs（如聚酮、非核糖体肽等）自然地聚集在一起，形成了不同的“大陆”。这为探索未知的“生物合成暗物质”提供了导航图。

**研究部分四：从计算预测到分子发现——IBIS 框架的湿实验验证**

**实验目的与设计**

本部分旨在通过真实的实验室工作，验证 IBIS 系统的预测能力是否可靠，能否指导新的天然产物发现。

设计思路是：

1. 利用 IBIS-BGC 嵌入向量数据库，在海量基因组中搜索与已知重要化合物（如 amicoumacin 和 xenoamicin）的 BGC 相似的新 BGCs。
2. 锁定含有高相似度 BGC 的菌株（*Photorhabdus luminescens* 和 *Xenorhabdus szentirmaii*）。
3. 对这些菌株进行培养和代谢物组学分析。
4. 分离并鉴定目标化合物，验证预测的准确性。

**实验结果与分析**

实验取得了圆满成功。作者不仅在目标菌株中检测并分离到了预测的已知化合物 O-methylamicoumacin B 和 xenoamicin A，还额外发现并鉴定了一系列结构新颖的衍生物（如 lipoamicoumacin E, diamicoumacin A, xenoamicin I-K）。这一结果强有力地证明了 IBIS 不仅是一个理论计算框架，更是一个能够指导实际分子发现的强大工具。它成功地完成了从“基因型”到“化学型”的预测和验证闭环。

**研究部分五：IBIS 知识图谱——关联代谢、物种与生态，驱动科学假说生成**

**实验目的与设计**

本部分旨在展示 IBIS 知识图谱 (IBIS-KG) 的威力，即如何通过整合多维度数据来发现新的生物学规律和提出科学假说。

设计思路是：

1. 将 IBIS 的所有预测结果（酶、通路、BGCs）与细菌的分类学信息和生态位信息（如分离来源：植物、线虫等）整合到知识图谱中。
2. 进行统计分析，寻找特定 BGC 家族 (GCF) 与特定生态位之间的显著关联。
3. 利用知识图谱探索未充分研究的微生物类群的生物合成潜力。
4. 展示一个利用知识图谱发现潜在新颖代谢通路的案例。

**实验结果与分析**

IBIS-KG 展现了作为“科学发现引擎”的潜力。通过数据关联，它能揭示隐藏的生物学联系。例如，它成功地“重新发现”了已知的生态功能关联：一个 rhabdopeptide GCF 与线虫显著相关（已知其为线虫共生菌产生的毒力因子），一个 thaxtomin GCF 与植物伤口相关（已知其为植物病原菌产生的毒素）。更重要的是，它还能进行前瞻性探索，例如，作者发现了一个包含多个功能未知酶的操纵子，在知识图谱中显示它与植物根瘤显著相关，并基于其中已知酶的功能，提出了一个关于其在植物-微生物共生中可能作用的、可供实验验证的全新假说。

**五：总体结论**

1. **成功构建了 IBIS 框架**：本文成功开发了一个基于 AI 的、名为 IBIS 的一体化计算平台，能够对细菌代谢进行全面、高精度、高通量的分析。
2. **“嵌入”是核心技术**：通过将生物序列和基因簇转化为有意义的数值向量（嵌入），IBIS 实现了前所未有的分析速度和可扩展性，解决了传统生物信息学工具的瓶颈。
3. **性能全面超越前人**：在酶功能预测、BGC 识别与分类、以及 BGC 比较等多个关键任务上，IBIS 的性能均显著优于现有的主流工具。
4. **知识图谱驱动假说生成**：通过构建知识图谱，IBIS 能够整合多源数据，将代谢潜力与生态功能相关联，成为一个强大的科学假说生成引擎。
5. **具备实际应用价值**：通过湿实验验证，证明了 IBIS 能够准确指导发现新的天然产物分子，具有巨大的应用前景。

**贡献与影响**：这项工作为微生物基因组挖掘和代谢研究领域带来了范式性的变革。它将引领该领域从基于序列比对的“慢数据”时代，迈向基于 AI 和向量运算的“快数据”时代，极大地加速新药、新酶和新生物材料的发现进程。

**六：论文评价**

**优点与创新**

1. **框架的整体性与前瞻性**：最大的创新在于其“大一统”的设计思想，用一套连贯的 AI 逻辑（嵌入）打通了从微观（酶）到宏观（代谢网络与生态）的各个分析层面，而非开发另一个“单点”工具。
2. **精妙的 AI 模型设计**：在 IBIS-BGC 中使用化学相似度指导对比学习，是连接基因型和化学型的神来之笔，确保了嵌入的化学意义，技术创新性极高。
3. **无与伦比的可扩展性**：在数小时内完成数百万 BGC 的比较和聚类，这种处理能力是现有工具无法企及的，真正解决了大数据时代的挑战。
4. **坚实的实验验证闭环**：计算生物学论文往往止步于性能指标的比较，本文通过扎实的天然产物化学工作，完成了从预测到分子实物的验证，极大地增强了结论的说服力。

**未来研究方向**

1. **整合多组学数据**：目前的 IBIS 主要基于基因组数据，预测的是“代谢潜力”。未来可以将转录组、蛋白质组和代谢组数据整合进知识图谱，以预测在特定条件下哪些代谢通路是“实际活跃”的，从而更精准地指导研究。
2. **从嵌入到结构预测**：利用 IBIS-BGC 生成的化学感知嵌入，可以将其作为输入，训练一个生成式 AI 模型，直接预测该 BGC 产物的化学结构。这将是基因组挖掘领域的终极目标之一。
3. **增强模型的可解释性 (XAI)**：深度学习模型常被称为“黑箱”。未来的研究可以引入可解释性 AI 技术，分析在 IBIS-BGC 的嵌入中，是哪些基因或结构域对最终的化学类型起到了决定性作用，从而加深我们对生物合成逻辑的理解。

**七：关键问题及回答**

**问题一：相比于 antiSMASH 等基于 pHMM 的传统工具，IBIS 的核心优势是什么？**

**回答**：IBIS 的核心优势在于其基于深度学习“嵌入”的全新范式，这带来了三大提升：

1. **更高的泛化能力和覆盖度**：antiSMASH 依赖于一个预先构建的、有限的 pHMM 库来识别保守结构域。如果一个 BGC 包含许多新颖的、库中没有的酶，antiSMASH 就可能漏掉或错误分类。而 IBIS 的 Transformer 模型通过学习蛋白质序列的“语言”，能够理解更普适的生化规律，因此可以识别和分类训练集中未见过的酶和 BGC（如 Figure 2B 所示），具有更强的发现新颖代谢通路的能力。
2. **更高的准确性**：由于能够整合更丰富的上下文信息（整个蛋白质序列或整个基因簇的图结构），IBIS 在预测 BGC 化学类型等任务上比基于局部规则匹配的 pHMM 方法更准确（如 Figure 3B 所示）。
3. **无与伦比的速度和可扩展性**：pHMM 扫描和序列比对是计算密集型任务。IBIS 将所有生物实体转化为向量后，所有的比较都变成了高效的数学运算。如 Figure 2E 所示，其注释速度远超传统方法，使其能够处理海量的基因组数据。

**问题二：作者是如何确保 IBIS-BGC 模型生成的 BGC 嵌入向量能够真正反映其产物的化学特性？**

**回答**：作者采用了一种非常巧妙的训练策略，即**基于化学相似度的对比学习 (Contrastive Learning)**，来确保嵌入的化学意义。

1. **定义“相似”与“不相似”**：他们利用化学信息学的标准——Tanimoto 相似度，来计算任意两个已知 BGC 产物分子的结构相似性。这就为模型提供了一个“黄金标准”或“教师信号”。
2. **训练目标**：在训练过程中，模型的目标是调整其参数，使得：如果两个 BGC 的产物分子在化学上是相似的（Tanimoto 系数高），那么它们各自的嵌入向量在数学空间中的距离就应该被“拉近”；反之，如果产物分子不相似（Tanimoto 系数低），它们的嵌入向量就应该被“推远”（如 Figure 4A 示意）。
3. **结果验证**：训练完成后，IBIS-BGC 嵌入向量之间的距离与产物分子间的 Tanimoto 相似度表现出强烈的正相关性（皮尔逊相关系数 r = 0.480），远高于之前的方法（Figure 4B）。这有力地证明了模型成功地将复杂的基因信息编码为了具有化学意义的“指纹”。

**问题三：IBIS 知识图谱 (IBIS-KG) 在实际科研中能解决什么问题？它如何超越一个简单的数据库？**

**回答**：IBIS-KG 远不止是一个数据库，它是一个**科学假说生成引擎**。它通过将 IBIS 的预测结果与多维度的生物学元数据机关联，解决了“信息孤岛”的问题，从而能够发现新的科学规律。
具体来说，它可以解决以下问题：

1. **功能导向的菌株筛选**：研究人员不再需要盲目筛选菌株。例如，如果想寻找一种新的抗线虫药物，可以在 IBIS-KG 中查询“哪些 BGC 家族在线虫相关的生态位中显著富集？”。知识图谱会返回一个排序列表，指导研究人员优先关注那些与线虫共生或寄生的细菌中的特定 BGC 家族。文中 rhabdopeptide 的例子就证明了这一点。
2. **理解新颖基因的功能**：当发现一个功能未知的基因簇时，可以在 IBIS-KG 中查询“这个基因簇主要存在于哪些物种中？这些物种通常生活在什么环境中？”。如果发现它只存在于一类特定的植物根际细菌中，这就为推测其功能（可能与植物共生、固氮或抵抗病原菌有关）提供了强有力的线索。文中关于根瘤相关操纵子的例子就展示了这种应用。
3. **宏观生物合成规律探索**：研究人员可以提出更宏大的问题，例如“放线菌和变形菌在生物合成策略上有何系统性差异？”或“海洋环境中的 BGC 与土壤环境中的 BGC 在化学类型上有何不同偏好？”。知识图谱的全局视角使得回答这类系统性的生态化学问题成为可能。

因此，IBIS-KG 通过**上下文关联**和**统计推断**，将静态的数据转变为动态的、可探索的知识网络，从而主动地为科学家提出值得研究的、有数据支持的新假说。

