
**PyMOL绘制分子对接结果**

\1. **前期准备**

1.1 **分子对接**

[AutoDock vina 安装及使用教程](..\AutoDock vina 使用教程\AutoDock vina 安装及使用教程.md)



1.2 **PyMOL 安装**

[PyMOL-开源版安装及使用教程](PyMOL-开源版安装及使用教程.md)

\2. **载入文件**

1. 经过 AutoDock vina 对接之后，目标化合物共生成 9 个构象，我们首先选择得分最高的对接结果进行可视化分析。

2. **File** --> **open** 导入分子对接生成的结果文件，可以看到软件视图界面出现了小分子化合物在对接中的第一种构象。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

3. **File** --> **open** 导入蛋白质结构文件，可以看到软件视图界面出现了蛋白质，且小分子已与蛋白子对接在一起

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

4. 此时，蛋白子和小分子是分离的，每次查看对接结果都需要分别将二者导入，比较麻烦。因此我们选择将小分子和蛋白质共同保存在一个 pdb 文件内。

5. **File** --> **export molecule**，在弹出的窗口中，同时选中蛋白质和小分子文件，选择保存为一个文件，保存所有的状态，点击 **OK**，在新弹出的窗口中将此结果保存为 pdb 格式，此文件即为同时包含蛋白质和小分子的一种对接结果。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

6. 点击图中 **A** --> **delete object**，分别删除小分子和蛋白质。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

\3. **小分子和蛋白质的可视化处理**

1. **File** --> **open** 导入刚刚保存的完整结果，可以看到蛋白质和小分子是一个整体。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

2. 点击最下方的 **S**，显示蛋白质的氨基酸序列。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

3. 点击窗口视图中右下角的 **Selecting**，将其调整为 **Chains** 模式，点击图中的蛋白质，并在窗口视图右侧的 **sele** 处点击 **A** --> **rename selection**，将蛋白质命名为 g3503。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

4. 点击图中的小分子，并在窗口视图右侧的 **sele** 处点击 **A** --> **rename selection**，将小分子命名为 6-MSA。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

6. 分别点击小分子和蛋白质，若发现对应的结构能够显示，则代表我们选择的是对的。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

7. 接下来改变他们的颜色，点击可视化窗口中的 **c**，将蛋白质 g3503 的颜色调整为 **gray90**，将小分子 6-MSA 的颜色调整为 **greencyan**。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.003.png)

\4. **氢键和氨基酸残基的展示**

1. 展示配体和蛋白质之间的氢键，并找出与配体通过氢键连接的氨基酸残基。将蛋白质的供状结构展示出来，并放大以便更清晰地观察。

2. 选中窗口视图中小分子 6-MSA 中 **A** --> **Find** --> **polar contacts** --> **to other atoms in object**，找出小分子与其周围氨基酸残基之间的氢键，可以看出显示出了一根氢键。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

3. 此时为了确定与小分子存在氢键作用的具体氨基酸残基，我们点击右侧窗口视图中蛋白质 g3503 的 S --> sticks，显示出了蛋白质上的球棍模型。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

4. 摁住鼠标右键，通过拖拽放大蛋白质结构。点击窗口视图中右下角的 **Selecting**，将其调整为 **Residues** 模式，选中与小分子存在相关的氨基酸残基，我们点击右侧窗口视图中 sele 的 **C** --> **magentas** --> **hotpink**，将该氨基酸残基改为酒红色。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

5. 然后点击右侧窗口视图中 sele 的 **A** --> **rename selectes**将该氨基酸残基命名为 A

6. 由于仅存在一个氢键作用，相互作用力太少，因此我们选择将小分子周围 5A 距离内的氨基酸残基都展示出来。

7. 首先我们点击右侧窗口视图中小分子 6-MSA 的 **A** --> **copy to object** --> **new**，新建一个小分子副本 obj01，点击右侧窗口视图中 sele 的 **A** --> **rename selectes**将该小分子副本命名为 6-MSA-1。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

8. 然后点击我们点击右侧窗口视图中小分子 6-MSA-1 的 **A** --> **modify** --> **around** --> **residues within 5A**，将小分子周围 5A 的氨基酸展示出来。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

9. 我们点击右侧窗口视图中 小分子 6-MSA-1 中的 **C** --> **cyans** --> **greencyan**，将该氨基酸残基改为 青绿色。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

10. 我们点击右侧窗口视图中蛋白质 g3503 的 **H** --> **sticks**，隐去蛋白质上的球棍模型。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

11. 我们点击右侧窗口视图中 小分子 6-MSA-1 中的 **S** --> **sticks**，显示蛋白质上的球棍模型。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)



12. 点击菜单栏上的 **Display** --> **background** --> **white**，将背景调为白色。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

13. 此时大概的轮廓已经有了，首先点击右上角的 **ray**，渲染图片。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

14. 然后们在命令行输入下列命令，将其导出。

```Markdown
#在工作目录保存一张名为 g3503-6-MSA 的 png 图片，像素为 5000 x 5000 px，分辨率为 1200 dpi。
png g3503-6-MSA.png, 5000, 5000, dpi=1200```

此时就可以获得一张高清图片，保存在工作目录中

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.004.png)

\5. **细节展示**

1. 点击菜单栏上的 **Setting** --> **Transparency** --> **cartton** --> **60%**，将图片中 cartoon 形式的蛋白部分透明度调为 60%。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

2. 点击右侧窗口视图中用于展示小分子周围 5 埃范围内氨基酸残基的图层（6-MSA-1）中的：**L** --> **resdiues**，显示这些氨基酸残基的名字和编号

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

3. 此时，图片中的 sticks 结构会遮挡氨基酸残基名字，从窗口视图右下角可以看出此时是 **viewing** 模式，无法手动改变氨基酸残基名字的位置。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

4. 点击窗口视图右下角的 **Mouse Mode 3-Button Viewing**，将其切换为 **Mouse Mode 3-Button Editing** 模式。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

5. 摁住键盘上的 **Ctrl** 键，同时摁住鼠标左键，就可以移动氨基酸残基名字的位置，将其调到合适的位置

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.003.png)

6. 位置调整好之后，点击菜单栏中的 **Setting** --> **Lable** --> **Size** --> **18 point**，将 Lable 的字体设置为 18 字号，此时字体大小不会随着图片的放大缩小而变化。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.002.png)

7. 图中显示了氢键，点击右侧窗口视图中的 6-MSA\_polar\_contact 中的 **S** --> **Lable**，即可显示出氢键的长度。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.003.png)

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.001.png)

8. 点击右侧窗口视图中用于展示小分子周围 5 埃范围内氨基酸残基的图层（6-MSA-1）中的：**C** --> **by element** --> **CHNOS**，用不同颜色表示这些氨基酸残基中的不同原子。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.005.png)

9. 点击右侧窗口视图中用于化合物 6-MSA 中的：**C** --> **by element** --> **CHNOS**，用不同颜色表示这些化合物中的不同原子。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.005.png)

10. 此时细节已经完整展示出来，点击右上角的 **ray**，渲染图片。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.006.png)

11. 然后们在命令行输入下列命令，将其导出。

```Markdown
#在工作目录保存一张名为 g3503\_6-MSA 的 png 图片，像素为 5000\*5000 px，分辨率为 1200 dpi。
png g3503\_6-MSA-1.png, 5000, 5000, dpi=1200```

12. 此时就可以获得一张高清图片，保存在工作目录中

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.004.png)

13. 点击菜单栏中的 **File** --> **save session as**，将该对接结果保存为 PyMOL 文件，后续可继续在该文件上进行编辑。

![...](..\..\..\0.%20软件教程\分子对接\PyMOL%20使用教程\images\PyMOL绘制分子对接结果.007.png)

